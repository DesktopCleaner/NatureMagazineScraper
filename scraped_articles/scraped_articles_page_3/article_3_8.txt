*** Enhancing the precision of measurements by harnessing entanglement is a long-sought goal in quantum metrology1,2. Yet attaining the best sensitivity allowed by quantum theory in the presence of noise is an outstanding challenge, requiring optimal probe-state generation and read-out strategies3,4,5,6,7. Neutral-atom optical clocks8, which are the leading systems for measuring time, have shown recent progress in terms of entanglement generation9,10,11but at present lack the control capabilities for realizing such schemes. Here we show universal quantum operations and ancilla-based read-out for ultranarrow optical transitions of neutral atoms. Our demonstration in a tweezer clock platform9,12,13,14,15,16enables a circuit-based approach to quantum metrology with neutral-atom optical clocks. To this end, we demonstrate two-qubit entangling gates with 99.62(3)% fidelity—averaged over symmetric input states—through Rydberg interactions15,17,18and dynamical connectivity19for optical clock qubits, which we combine with local addressing16to implement universally programmable quantum circuits. Using this approach, we generate a near-optimal entangled probe state1,4, a cascade of Greenberger–Horne–Zeilinger states of different sizes, and perform a dual-quadrature5Greenberger–Horne–Zeilinger read-out. We also show repeated fast phase detection with non-destructive conditional reset of clock qubits and minimal dead time between repetitions by implementing ancilla-based quantum logic spectroscopy20for neutral atoms. Finally, we extend this to multi-qubit parity checks and measurement-based, heralded, Bell-state preparation21,22,23,24. Our work lays the foundation for hybrid processor–clock devices with neutral atoms and more generally points to a future of practical applications for quantum processors linked with quantum sensors25.

*** The control of quantum systems is evolving rapidly on many fronts. On the one hand, quantum processors, which use quantum mechanics to perform calculations, have matured into intermediate-scale systems with high-fidelity entangling operations and universal control capabilities19,26,27,28,29,30,31,32,33. On the other hand, quantum sensors25and, in particular, optical atomic clocks8, which use quantum mechanics to measure time, have become both more accurate and more precise, thus revealing new phenomena34and enabling the measurement of relativistic effects at a laboratory scale35,36. Thus, a natural question and a long-sought goal is how to use quantum information processing tools and entanglement to improve quantum sensors.

*** Two main strategies are typically considered in this context1: entangled state preparation and entanglement-assisted measurements. For the first, entanglement introduces correlations between probes, resulting in jointly enhanced sensitivity; unfortunately, this also entails jointly enhanced vulnerability to errors and reduced dynamic range, which often nullifies or strongly reduces any effective gains3,4,37,38,39. Schemes to circumvent this apparent drawback use specific, finely tuned, entangled, probe-state preparation and read-out schemes1,4,6. Although one such scheme has been recently realized with trapped ions7, so far there has been no demonstration in neutral-atom optical clocks, despite recent progress in generating entanglement9,10,11.

*** Second, entanglement with an ancillary system can be harnessed in non-destructive read-out of a sensor to benefit metrology, for example, logic spectroscopy of inaccessible probes as demonstrated with ions20, sequential multi-round phase estimation1, fast mid-circuit detection for multi-ensemble metrology5, and shallow-circuit preparation of long-range entangled states21,22,23,24. Only very recently, ancilla-based read-out for hyperfine qubits in neutral atoms has been shown24,40, but a demonstration for ultranarrow optical transitions—as needed for optical atomic clocks—is outstanding. Further, it is critical that ancilla-based read-out can be performed repeatedly to fully realize its potential for metrology (and for quantum error correction41), which is an outstanding challenge for neutral atoms in general.

*** To demonstrate such complex entangled probe-state generation and repeated ancilla-based read-out, we realize a scalable universal quantum processor with neutral-atom qubits encoded in an ultranarrow optical transition (Fig.1a). Importantly, the same experimental system can be used as a neutral-atom optical clock8, which is at present the most stable frequency reference35,36. Specifically, our system is a tweezer optical clock9,12,13,14,15,16composed of neutral strontium-88 trapped in a tweezer array42(Fig.1b,c), which we now equip with universal quantum computing and repeated ancilla-based read-out capabilities.

*** a, We demonstrate a universal quantum processor based on optical clock qubits. This processor is designed to perform any computational task and is also a highly sensitive clock. To realize this device, we demonstrate high-fidelity entangling gates between optical clock qubits and circuits with dynamical reconfiguration. We combine these with local single-qubit rotations through subwavelength atomic shifts and local MCR.b, We use tweezer-trapped88Sr atoms. Qubits are based on the ultranarrow optical clock transition1S0↔3P0, and entangling operations are realized through transient excitation to a Rydberg staten3S1. We use coherent superpositions of quantized motional states in tweezers to shelve protected clock qubits for mid-circuit detection of ancilla qubits.c, We identify two instances where these universal quantum operations can be used in optimizing quantum metrology: entangled state preparation for near-optimal probes and entanglement-assisted read-out with ancilla qubits, thus realizing quantum logic spectroscopy for neutral atoms.

*** In particular, we demonstrate high-fidelity entangling gates17,18,27for optical clock qubits15, achieving a state-of-the-art controlled-Z(CZ) fidelity for neutral atoms of 0.9962(3) (averaged over symmetric two-qubit states). We generate an array of optical-clock-transition Bell pairs with a record fidelity. We further show that optical coherence is preserved during qubit transport in tweezers, which has previously been realized with hyperfine qubits19,43, enabling dynamical circuit reconfiguration. Together with high-fidelity global single-qubit rotations, single-site control16, and mid-circuit read-out (MCR)44, this allows us to take a circuit-based approach to realize strategies for entangled state preparation and read-out designed to improve metrology (Fig.1c).

*** We begin by demonstrating high-fidelity entangling gates for the ultranarrow optical clock transition. The optical transition defines a qubit composed of the ground state of strontium-881S0, denoted as\(| 0\rangle \), and the metastable state3P0, denoted as\(| 1\rangle \)(Fig.1b). To realize a high-fidelity entangling operation, we apply a single phase-modulated Rydberg pulse for a CZ gate, which has been shown to be time-optimal45,46and has recently been implemented in hyperfine and nuclear atomic qubits17,18. To simultaneously realize high-fidelity single-qubit rotations, we operate with a magnetic field of 450 G, which achieves a balance between a sufficiently high Rabi frequency on the clock transition (scaling linearly with the magnetic field) and sufficiently strong interactions (as the Rydberg interaction strength is magnetic field dependent;Methodsand Extended Data Fig.1). We prepare atoms in the\(| 1\rangle \)state and perform erasure-cooling44, which prepares atoms close to the motional ground state.

*** We characterize the performance of such gates with a randomized circuit (Fig.2a) designed to benchmark the CZ gate fidelity averaged over the two-qubit symmetric states (Methodsand Extended Data Fig.3). By varying the number of CZ gatesNCZ, we infer a CZ fidelity of 0.9962(3) by fitting the decay of the return probability as a function ofNCZto an exponential trend (Fig.2b). The quoted fidelity is corrected for the false contribution from leakage out of the qubit manifold during the gate (Methods). We numerically find this gate benchmark to be within 5% of the infidelity averaged over Haar random states for our gate parameters47. Our result sets a new state-of-the-art fidelity in Rydberg-based two-qubit entangling gates for long-lived qubits17,48.

*** a, Randomized circuit characterization of CZ gate fidelity averaged over symmetric input states prepared by\({\widehat{U}}_{{\rm{init}}}\). The circuit includes a fixed number of random single-qubit gatesRCand a variable numberNCZof CZ gates. The final unitary\({\widehat{U}}_{{\rm{rec}}}\)is precomputed to maximize the return probability\({P}_{| 11\rangle }\)in the absence of errors.b, By fitting the return probability as a function ofNCZ, we infer a gate fidelity of 0.9962(3) after correcting for the false contribution from leakage errors (Methods).c, A circuit for creating and characterizing the Bell state\(| {\varPhi }^{+}\rangle \).d, Parity oscillations with a measured bare parity contrast of\(0.96{3}_{-10}^{+7}\). Together with the population overlap (Methods), we obtain a Bell-state generation fidelity of\(0.97{6}_{-6}^{+4}\)(\(0.98{9}_{-6}^{+4}\)SPAM corrected). Inbandd, the data are conditioned on atom pairs surviving erasure-cooling, which occurs at a rate of 51%.e, Array configuration depicted by the average atomic fluorescence image. The interatomic separation is chosen to induce strong Rydberg interactions within each pair and avoid unwanted interactions between pairs.

*** As an important application of the CZ gate, we generate an array of Bell pairs with optical clock qubits (Fig.2c). After initializing atoms in superposition states and applying a CZ gate, a π/4 pulse rotates the state into the even-parity, metrologically relevant, Bell state\(| {\varPhi }^{+}\rangle =(1/\sqrt{2})(| 00\rangle +| 11\rangle )\). For the state obtained in the experiment, we measure the population overlap with the ideal Bell state and we drive parity oscillations (Fig.2d) to infer the off-diagonal (coherence) terms49. Overall, we obtain a Bell-state generation fidelity of\(0.97{6}_{-6}^{+4}\)(\(0.98{9}_{-6}^{+4}\)when corrected for state preparation and measurement errors (SPAM)) which is limited, beyond the CZ fidelity, by the finite fidelity of clock π/2 pulses and decoherence in the circuit (Methods).

*** Having demonstrated high-fidelity gates on optical clock qubits, we next prepare larger entangled states and execute algorithms requiring more complex circuits. Specifically, we first prepare a complex quantum register with metrological significance based on a cascade of entangled Greenberger–Horne–Zeilinger (GHZ) states. Such GHZ states enable, in principle, the best sensitivity for linear observables allowed by quantum theory—the Heisenberg limit—with precision scaling as 1/N, whereNis the number of atoms. However, for a singleN-qubit GHZ state, although the sensitivity to phase variations is increased by a factor ofN, the dynamic range of phases that can be unambiguously measured is likewise reduced by a factor ofN(refs.3,4,37). A similar trade-off exists for spin-squeezed entangled states38,39. Importantly, a smaller dynamic range means a shorter allowable interrogation time, resulting in precision loss.

*** A proposed scheme1,4for circumventing this trade-off between sensitivity and dynamic range requires the simultaneous preparation of a cascade ofMdifferent groups of GHZ-like states of the form\(| {\psi }_{j}\rangle \propto ({| 0\rangle }^{\otimes {2}^{j}}+{| 1\rangle }^{\otimes {2}^{j}})\)withj= 0, 1, …,M− 1. Such a probe state enables Heisenberg-limited sensitivity, up to logarithmic corrections, while preserving the dynamic range. It, thus, enables a viable path to quantum-enhanced metrology under realistic conditions in which local oscillator noise is the main limitation, as in current neutral-atom optical clocks37. Note that these proposals are quantum-enhanced extensions of the classical optimal interrogation schemes5,50that have recently been experimentally shown16,51.

*** We consider different circuit realizations for generating the required simultaneous preparation of GHZ states withj= 0, 1, 2, using our universal quantum processor aided by dynamical array reconfiguration. Although large GHZ states can be prepared with circuits applying extensive local control (Extended Data Fig.5), here we realize a circuit compiled with global control up to its final layer (Fig.3a). This choice is guided by the need to minimize idle time added by local operations, during which laser–atom dephasing occurs. The local control for single-qubit rotations is achieved through local phase shifts imparted through subwavelength shifts in atomic position16. The connectivity for two-qubit gates is realized by a mid-circuit array reconfiguration (Fig.3b). We verify the simultaneous preparation of increasingly phase-sensitive states by varying the phase of a final π/2 pulse and measuring the parity signal\(\widehat{{\mathcal{P}}}=\prod _{i}{\widehat{Z}}_{i}\)for each GHZ state. Plotting this signal against phase in Fig.3cgives a ratio in phase sensitivity of 1:1.96(6):3.9(1), which is consistent with the 1:2:4 ratio expected.

*** a, Quantum circuit for the simultaneous preparation and characterization of GHZ states of the form\(| {\psi }_{j}\rangle \propto ({| 0\rangle }^{\otimes {2}^{j}}+{| 1\rangle }^{\otimes {2}^{j}})\), wherej= 0, 1, 2.b, Array reconfiguration steps depicted by average atomic fluorescence images at each one-dimensional array configuration (1), (2) and (3), as marked in the circuit ina. Dashed arrows represent atom movements performed between two sequential array configurations.c, Simultaneous parity oscillations forj= 0, 1 and 2, from top to bottom, showing a 1:1.96(6):3.9(1) ratio in phase sensitivity.d, Simultaneous dual-quadrature parity read-out of two copies of a four-atom GHZ state realized through a π/8 phase shift on each atom in one copy, resulting in a collective π/2 phase shift before the final read-out pulse.

*** This demonstration measures only one quadrature of the optical phase signal. Importantly, the dynamic range can be doubled if both phase quadratures are probed simultaneously, the so-called dual-quadrature read-out4,5,16,51. We demonstrate such a dual-quadrature read-out for entangled states (Fig.3d) by preparing two four-atom GHZ states and then imparting a phase rotation to only one through local phase shifts. This enables the read-out in the\(\widehat{Y}\)-basis in parallel to the read-out in the\(\widehat{X}\)-basis. Here, a π/8 phase shift per atom (π/2 phase on the entangled four-atom register) is realized by moving16all four atoms byλ/16 ≈ 44 nm. Note that such phase shifts could alternatively be realized by moving a single atom in the GHZ state byλ/4.

*** An important question concerns the limitations on the maximum attainable size of a GHZ state in terms of achievable fidelity. We hypothesize that the phase noise of our clock laser was the dominant error source, which we test with experimental and numerical investigations. In the simultaneous GHZ-state preparation scheme, we achieve a bare parity contrast of 0.52(3) forN= 4 (Fig.3c). To reduce the impact of clock laser phase noise, we prepareN= 4 andN= 2 GHZ states using a circuit with a shorter idle time, which is the wait time during which operations are done on other registers (by removing the single-site operation\({\widehat{Z}}^{\frac{1}{4}}\)shown in Fig.3a). With this sequence, we find an improved contrast of 0.68(3) and a fidelity of 0.71(2) (Extended Data Fig.9). Note that the contrasts from both sequences are at or above the threshold of\(1/\sqrt{N}=0.5\)required for a metrological gain2,52for a fixed, short interrogation time. However, they do not exceed the higher threshold for the cascaded-GHZ scheme (Methods).

*** Motivated by this, we study fidelity as a function of the circuit idle time. We measure the decay in fidelity and a modification of the bit-string distribution (Extended Data Fig.9), which follows the prediction of our error model, consistent with our hypothesis that clock laser phase noise is the dominant error source. We then run a model using a frequency noise spectrum of a 26-mHz clock laser system53, for which we predict aN= 4 GHZ-state fidelity of approximately 0.97 (Methodsand Extended Data Fig.6). Thus, we expect significantly improved results with an upgraded clock laser system, which would surpass the metrological gain threshold for the cascaded-GHZ scheme, even for largerN(Methodsand Extended Data Fig.7).

*** Having used entanglement to prepare metrological probe states, we next use it to read out the resulting state. Specifically, we demonstrate a method based on mapping quantum information from a set of sensor qubits to a set of ancillary qubits, which are measured while the sensor qubits are quickly available for sensing once more. Such repeated, non-destructive, ancilla-based measurements are a central building block in quantum error detection and correction41. In a metrological context, repeated mid-evolution measurement and reset cycles are desirable for efficient multi-ensemble schemes5. These schemes enable extended dynamic range and effective coherence time, even in the absence of entangled probes. However, realizing fast mid-circuit measurement and the reset of atomic qubits is challenging due to the overhead in resetting both the motional state and the electronic state of a qubit after direct measurement.

*** To efficiently realize an ancilla-based read-out in atomic systems, information-carrying data qubits must first be protected from global imaging light and their coherence must be preserved during the MCR of ancilla qubits. Such protection can be realized by using dual-species arrays40, cavity-assisted read-out54, a separate read-out zone24or shelving to states that are dark to imaging light55,56,57. For our system, we took the last approach and have recently realized MCR44by shelving optical qubits into superpositions of motional states that are long-lived and dark to imaging light.

*** By performing high-fidelity entangling gates between information-carrying (clock) qubits and ancilla qubits before MCR (Fig.4a), we realize a form of quantum logic spectroscopy with neutral-atom optical clock qubits, as originally introduced for mixed-species ion traps20. In our case, we use local control to prepare certain atoms in superposition states sensitive to the clock laser detuningΔ, whereas ancilla atoms remained in the insensitive state\(| 1\rangle \). Clock qubits acquire a time-dependent phaseΔ×t, which is mapped onto the population in a Ramsey sequence. A subsequent clock-ancilla CNOT gate (controlled on qubit state\(| 0\rangle \)) then maps this signal onto the ancilla state (Fig.4b). This sequence realizes an ancilla-based detection of\(\widehat{X}\)of the clock qubit.

*** a, We consider three ensembles of atoms: reference (Ref.) atoms (R; red), clock atoms (C; purple) and ancillas (A; blue). An entangling gate maps the state of clock atoms to the state of ancilla atoms before the MCR of the ancilla state.b, Logic spectroscopy with ancilla atoms. A Ramsey interrogation is performed in parallel on reference atoms (R) and clock atoms (C). A clock-ancilla CNOT gate (controlled on qubit state\(| 0\rangle \)) maps the state onto ancilla atoms (A) for read-out.c, Ancilla-based\(\widehat{X}\)measurement. A non-destructive measurement of the state\({| \psi \rangle }_{C}\)is realized by shelving clock qubits (\(\widehat{S}\)operation) followed by ancilla MCR. We show that following the unshelving (\({\widehat{S}}^{\dagger }\)), the state of the clock qubit is projected to a well-defined state in the measurement basis, conditioned on the ancilla state.d,Ncycrepeated rounds of quantum logic spectroscopy with minimal dead time (2.9 ms), enabled by ancilla replacement through an array reconfiguration. Each roundjconsists of a fixed evolution timeTjfollowed by ancilla-based\(\widehat{X}\)measurement before a final round where the clock qubit is directly measured in a Ramsey sequence with variable timet.e, We find improved contrast in the final measurement round when conditioned on ancilla results (see text) in all previous rounds (purple markers) compared to the reference clock atoms, which are protected during MCR but do not interact with the ancillas (red markers).

*** To realize a non-destructive ancilla-based\(\widehat{X}\)measurement, we then shelve clock qubits and read out the ancilla state. Thus, we ramp up the depth of ancilla traps by a factor of 5 (leaving traps with clock atoms unchanged) such that they are not resonant with the global motional shelving drive. Following shelving of clock qubits, we perform ancilla MCR of the signal fieldΔ. Conditioned on the ancilla measurement result, the clock atom is projected to a known state in the measurement basis, which enables repeated interrogation. We verify this by measuring the clock qubit state in the\(\widehat{X}\)basis through a π/2 pulse with a variable phaseϕbefore detection (Fig.4c). We find that the clock qubit is projected onto the\(| \,+\,\rangle \)(\(| \,-\,\rangle \)) state conditioned on the ancilla measurement result\(| 0\rangle \)(\(| 1\rangle \)) in the\(\widehat{Z}\)basis, with a contrast of 0.84(4) (0.73(4)). These results were conditioned on successful one-way shelving18,44(Methods).

*** Ideally, a non-destructive read-out enables repetitive measurements of the same qubit or the same register. This can be achieved by resetting the ancilla qubit and repeating the read-out cycle. We use an 18 μs fast imaging method58that is much shorter than the qubit coherence time but results in a high probability of losing the ancilla atom during imaging. We, thus, realize repeated rounds of measurement and reset by replacing the ancilla atom with a reserve atom, which was shelved during ancilla MCR, using dynamical reconfiguration. This yields a dead time of only 2.9 ms, which is dominated by shelving and unshelving operations. Alternatively, we demonstrate the reuse of the same ancilla atom by applying a 10 ms low-loss imaging followed by recooling (Methodsand Extended Data Fig.10).

*** We use ancilla-based read-out to perform fast and repeated phase detection (\(\widehat{X}\)measurement) cycles with a clock qubit reset (Fig.4d). In Fig.4e, we plot the resulting Ramsey signal for up to three consecutive measurement rounds. We use information from ancilla detection in previous rounds to remove shots where the ancilla state was toggled from\(| 1\rangle \)to\(| 0\rangle \)(maintaining 78% of the experimental shots for a single round of ancilla detection), indicating a phase flip. We contrast this with reference qubits that did not interact with ancillas and find an improved contrast for the ancilla-based detection. For the latter, the contrast is limited by the fidelity of shelving and unshelving operations as part of the MCR.

*** Although we use ancillas to measure a single qubit, extending our demonstration to a larger ensemble of ancillas interacting with an ensemble of clock qubits would enable single-shot phase estimation of the global fieldΔ. Information on phase deviation outside the dynamic range could be used to correct the phase estimation of the longer evolving ensemble realized by the reference qubits in our demonstration5. Such fast detection and reset are further advantageous for low dead-time clock operation, as this would reduce the instability due to the Dick effect8. On the other hand, using ancillas in a single-species array comes at the expense of a reduced number of clock qubits, which would increase the quantum projection noise, so that the metrological gain depends on the balance of the two.

*** We next generalize our experimental demonstration of ancilla-based read-out to multi-qubit measurements. In a multi-qubit measurement, an ancilla is entangled with several qubits and then measured. The measurement projects the register qubits to a well-defined parity subspace. This may prove especially useful for preparing large-scale long-range entangled states, such as GHZ states, through ancilla measurements21,22,23,24, for which we show a proof-of-principle for optical qubits. Note that multi-qubit measurements, which measure higher-weight observables, are also central to stabilizer-based quantum error correction41.

*** We demonstrate the lowest-order version of such schemes, a weight-2 parity measurement for which the ancilla is entangled with two different clock qubits before measurement. To do this, we prepare an input state composed of an ancilla atom in the clock state\(| 1\rangle \)and two atoms in a Bell state and perform a\(\widehat{X}\widehat{X}\)parity measurement (Fig.5a). Figure5bcompares the direct read-out of a parity signal from the Bell pair (pink) with the ancilla read-out (orange). We find that, indeed, the single ancilla atom observable now oscillates at a frequency of twice the single-atom detuningΔ. This frequency, as well as the phase of the signal, is consistent with a direct read-out of the Bell-pair parity (Methods).

*** a, An ancilla qubit (middle) is prepared in parallel with a Bell pair, which is then used in Ramsey interrogation. A parity signal is measured either directly on the Bell pair or through ancilla-based parity read-out.b, Direct read-out of the Bell-pair parity signal (pink) is compared with a single ancilla read-out (orange) yielding a weight-2 parity signal oscillating at the same frequency and phase within error bars (Methods).c, A circuit for the measurement-based preparation of a long-range Bell pair, composed of three-qubit cluster state generation followed by MCR on the middle ancilla qubit. Conditioning on the ancilla result\(| 0\rangle \)(approximately 45% of experimental shots) projects the two exterior atoms to the Bell state\(| {\varPhi }^{+}\rangle \).d, Characterization of the resulting Bell state with population overlap of 0.71(2) in the even-parity subspace\(\{| 00\rangle ,| 11\rangle \}\). The parity oscillation of the resulting state yields a contrast of 0.52(3), resulting in an overall raw Bell-state fidelity of 0.61(2). Data were conditioned on the successful shelving of the two exterior qubits (approximately 82% of experimental shots).e, A proposal for a continuous clock based on a modular architecture (see ‘Outlook’ for details).

*** We next demonstrate another relevant application of the conditional parity projection in a weight-2 ancilla MCR: long-range entanglement induced by measurement21,22,23,24. We first prepare a three-qubit cluster state and then perform MCR of the central qubit in the\(\widehat{X}\)basis (Fig.5c). As\(\widehat{Z}\widehat{X}\widehat{Z}\)is a stabilizer of the cluster state, this measurement generates a Bell pair with a well-defined parity for the exterior atoms. Conditioning on the ancilla result\(| 0\rangle \), we find the Bell state\(| {\varPhi }^{+}\rangle \)with population 0.71(2) in the even-parity subspace\(\{| 00\rangle ,| 11\rangle \}\)and a parity oscillation contrast of 0.52(3), yielding an overall raw fidelity of 0.61(2) (Fig.5d). When, instead, we condition on the ancilla result\(| 1\rangle \), the state is projected to the odd-parity Bell state\(| {\varPsi }^{-}\rangle =(1/\sqrt{2})(| 01\rangle -| 10\rangle )\), which is not metrologically useful in our context, with 0.64(2) in the odd-parity subspace\(\{| 01\rangle ,| 10\rangle \}\). Alternatively, by performing an ancilla-based\(\widehat{X}\widehat{X}\)measurement, one can prepare both metrologically relevant Bell states\(| {\varPhi }^{+}\rangle ,| {\varPhi }^{-}\rangle =(1/\sqrt{2})(| 00\rangle -| 11\rangle )\). Such schemes can be considered a heralded preparation, which could be made deterministic by a feedback operation21,22,23,24. Note that with improvements in fidelity and with sufficiently fast feedback, this could then be readily extended to the measurement-based preparation of large-scale GHZ states with only a constant-depth circuit21,22,23. This is in contrast to linear or log-depth standard unitary circuits31and could be instrumental for generating large-scale optical clock GHZ states in future devices.

*** Our results demonstrate how universal quantum processing and ancilla-based read-out can be integrated with a neutral-atom optical clock. Extending such schemes to larger two-dimensional tweezer clock systems14would enable the creation of several copies of GHZ states at a given size. Note that, in particular, the schemes demonstrated here could easily be generalized to two dimensions by performing all operations for a set of rows in parallel to generate several copies of GHZ states. We see this as a viable avenue towards the quantum-enhanced operation of neutral-atom clocks using cascades of GHZ states1,4combined with classically optimal interrogation schemes and quadrature read-out5,16,50,51.

*** We have demonstrated a CZ fidelity of 0.9962(3), averaged over two-qubit symmetric states, providing state-of-the-art entangling gate fidelity, as well as the full toolbox needed to execute relevant algorithms for metrology and computation with optical clock qubits. The main limitation for current circuit fidelities is the clock laser phase noise, which results in dephasing during circuit idle times. The ancilla-based MCR is further limited by the fidelity of shelving qubits in motional states. Upgrading the clock laser system used in this work to match the current state of the art14,35would enable the generation of significantly larger GHZ states than demonstrated here (Extended Data Fig.6andMethods). We expect the maximum size of a GHZ state will eventually be limited by a combination of clock laser phase noise and CZ gate fidelity. In this context, note that the CZ gate fidelity is at present dominated by the phase noise of the Rydberg laser (Extended Data Fig.4andMethods), which could easily be improved by implementing cavity filtering techniques. Further, using native, multi-qubit gates17,59or effective all-to-all connectivity19could reduce the required circuit depth. Ancilla-based MCR could also be improved with a higher stability clock laser and better control and homogenization of the trap waists44. Finally, GHZ states can be prepared with constant-depth circuits through measurement-based schemes21,22, for which we show the first steps with optical clock qubits in Fig.5c,d.

*** Our results further point to a modular device with distinct quantum processing and sensing modules. This would realize a quantum computer connected to a high-precision sensor (Fig.5e). The processing module could be used to prepare entangled probe states in parallel to sensing, followed by a state exchange operation between the sensor and the processor. Subsequently, read-out could be performed in the processing module in parallel to sensing, before preparing new entangled probe states, which would yield very low dead-time operation. Options for fully realizing this vision could be based on a multi-zone approach with a single species24, a dual-species40device composed of alkaline-earth and alkali atoms (for example, strontium and rubidium), an optical-metastable-ground-state qubit architecture56,60or combinations thereof. Several of our results can be viewed as proof-of-principle demonstrations towards this modular vision, including state exchange operations (Extended Data Fig.11) and higher-weight ancilla-based read-out. In the quest to push the limits of precision measurements, such a device could be part of next-generation quantum technologies from field-transportable sensors to state-of-the-art optical clocks35.

*** Our experimental set-up has been detailed in previous work13,16,58. Here, we discuss the experimental requirements specific to executing quantum circuits on a quantum processor with optical clock qubits. In particular, several trade-offs need to be balanced in the choice of magnetic field, trap depth and interatomic spacing.

*** Due to laser frequency noise, high-fidelity single-qubit rotations benefit from a large Rabi frequency on the clock transition (1S0↔3P0). The clock-transition Rabi frequency scales linearly with the magnetic field, and we achievedΩ= 2π × 2.1 kHz at 450 G. On the other hand, the Rydberg interaction strength varies with the magnetic field due to admixing with other Rydberg states61. Specifically, a numerical calculation (using the ‘Pairinteraction’ package61and limiting the considered Rydberg states ton± 5 for faster convergence) shows that the interaction energy peaked around 380 G and decreases for higher magnetic fields (Extended Data Fig.1a). Our experimental measurements for several magnetic fields are consistent with this overall trend. Therefore, we operate at a magnetic field of 450 G, which provides a balance between a sufficiently high clock Rabi frequency and sufficiently strong Rydberg interactions.

*** Our nominal tweezer trap depth (U0≈ 450 μK) is chosen to ensure efficient atom loading and high-survival, high-fidelity imaging62, as well as efficient driving of the carrier transition for clock qubits. However, we find that the Rydberg gate performs slightly better when the trap is turned off. In our case, this is predominantly due to beating between adjacent tweezers, which results in trap-depth fluctuations at a frequency of 650 kHz (equal to the tone separation on our tweezer-creating acousto-optic deflector). As the Rydberg transition (3P0↔ 613S1) is not under magic trap conditions, this results in detuning noise for the gate operation. For an optimized CZ gate with traps kept on at 0.2U0, we find that the two-qubit gate fidelity is lower by approximately 3 × 10−3(not shown). By placing an acousto-optic modulator in the tweezer optical path, we implement a fast switch-off of the trapping light (rise/fall time of the order of 50 ns). At this timescale, we find that switching traps off from a shallower trap 0.2U0is preferable as this imparts minimal heating with no observed loss for clock qubits. Furthermore, in MCR, efficient motional shelving relies on strong sideband coupling44, which becomes stronger as the Lamb–Dicke factor increases (trap depth decreases). On the other hand, array reconfiguration benefits from sufficiently deep traps.

*** The experimental sequence, thus, involves adiabatic ramps of trap depth as well as fast switch-off and -on. After loading the atoms into the tweezers atU0, we lower the tweezer depth to 0.5U0to perform erasure-cooling44. For gate operations, we drive coherent clock rotations at 0.2U0and switch the trap off for about 500 ns to perform the Rydberg entangling pulse. When selective local MCR is applied, we adiabatically ramp to deeper traps ofU0for the ancilla qubits, while holding the clock qubits at fixed depth.

*** We now discuss how we perform the dynamical array reconfiguration, shown in Fig.1as part of a full quantum operation toolbox. We coherently transport an atom across several sites by performing a minimal-jerk trajectory that followsx(t) = 6t5− 15t4+ 10t3fort∈[0, 1]. For this trajectory, the acceleration is zero at the two end points, which avoids the sudden jump in the acceleration profile and minimizes the associated jerk. The aim is to achieve minimal heating, which is especially important for driving optical clock transitions in the sideband-resolved regime.

*** With this trajectory, we find no significant temperature increase for atoms transported over four sites (equivalent to 13.26 μm) in 160 μs at trap depthU0(Extended Data Fig.1b). This is the typical distance applied in dynamical array reconfiguration. Another interatomic spacing choice is 13.26 μm ≈ 19 × 698 nm (corresponding to the clock-transition wavelength), which would ensure an effective zero displacement-induced phase shift16.

*** We characterize our ability to perform coherent single-qubit rotations with a global addressing beam and test our error model by driving the clock transition on atoms with an average motional occupation of\(\bar{n}\approx 0.01\), following erasure-cooling along the optical axis44. We drive Rabi oscillations with a nominal Rabi frequencyΩ= 2.1 kHz and observe 52.2(8) coherent cycles (Extended Data Fig.2a). Applying a train of π/2 pulses along theXaxis, we find a per-pulse fidelity of 0.9988(2). Note that in such sequences, the effect of slow frequency variations is suppressed. We, thus, characterize the π/2 pulse fidelity by applying a pulse train of π/2 pulses with random rotation axes ±Xand ±Y(ref.63). The resulting π/2 pulse fidelity is measured to be 0.9978(4) (Extended Data Fig.2c).

*** The dominant error source in the single-qubit operation is laser frequency noise, which is characterized by the frequency power spectral density (PSD) functionSν(f). We characterize this with Ramsey and spin-lock64sequences.

*** The Ramsey sequence is sensitive to the low-frequency component of the laser frequency PSD up to the inverse of the Ramsey interrogation time (approximately 100 Hz). In our experimental set-up, we observe day-to-day fluctuations in the Ramsey coherence time (Extended Data Fig.2d). We use an effective model of the PSD at low frequencies (Extended Data Fig.2f) to account for the fluctuations of the Ramsey coherence time. We set the PSD to be a constantHat low frequencies up to some frequency of interest (approximately 200 Hz) and find numerically that the Ramsey coherence time was inversely proportional toH.

*** To probe and quantify fast frequency noise up to our Rabi frequency, we perform a spin-lock sequence. We initialize all atoms in an eigenstate of\(\widehat{X}\)and turn on a continuous drive along theXaxis for a variable time. Then we apply a π/2 pulse along theYaxis, which transfers all atoms into state\(| 1\rangle \)in the absence of errors. The probability of returning to\(| 1\rangle \)decays over time (Extended Data Fig.2e), and the decay rate is predominantly sensitive to frequency noise at this Rabi frequency64. By varying the Rabi frequency of the continuous drive field and measuring the decay of the probability in\(| 1\rangle \), we determine the frequency PSD by using the linear relation between the decay rate and the frequency PSDSν(f) at the Rabi frequency (Extended Data Fig.2f).

*** To account for both the fast frequency noise measured by the spin-lock experiment and the slow frequency noise that determines the Ramsey coherence time, we interpolate the laser frequency PSD with a power-law function\({S}_{\nu }(f)={h}_{0}+{({h}_{\alpha }/f)}^{\alpha }\)upper-bounded byHat low frequencies. The model parametersh0,hαandαare obtained by fitting the spin-lock data (Extended Data Fig.2e,f). The upper boundHis flexible within a range (shown as the shaded area in Extended Data Fig.2f) and can effectively describe the day-to-day fluctuations of the Ramsey coherence time. This range is reflected in the uncertainties of the error model predictions quoted throughout this work.

*** In addition to laser frequency noise, note that although the single-qubit operations are sensitive to the finite temperature, we perform erasure-cooling44to prepare atoms close to their motional ground state (\(\bar{n}\approx 0.01\)). This has a negligible impact (approximately 1 × 10−4) on the clock π/2 pulse fidelity, as predicted by our error model.

*** In addition to the error sources described above, we also include laser intensity noise, pulse shape imperfection, spatial Rabi frequency inhomogeneity and Raman scattering induced by the tweezer light. All these error sources result in an aggregate of approximately 1 × 10−4infidelity for the clock π/2 pulse.

*** With all described error sources included, the error model predicts an average π/2 fidelity of 0.9981(8) (Extended Data Fig.2c), which is in good agreement with the experimental value of 0.9978(4).

*** Here, we give more details about the randomized circuit (Fig.2), which is used to benchmark the CZ gate fidelity. We first apply a randomized circuit like the one proposed and used in ref.17, which includes echo pulses (π pulses alongX) interleaved with random single-qubit rotations and CZ gates (Extended Data Fig.3a). For this circuit, we observe that both two-qubit (Rydberg) errors and single-qubit (clock) errors contribute to the inferred infidelity (Extended Data Fig.3b,c). That such a circuit is sensitive to single-qubit gate errors, although the number of single-qubit gates was kept fixed, is because the probability distribution of two-qubit states before each single-qubit gate changes as a function of the number of CZ gates applied. Note that as errors affect entangled states and non-entangled states differently, changing the probability distribution would result in a non-unity return probability, even if the fidelity of CZ gates were perfect, in the presence of single-qubit gate errors. In this context, the sequence used in Extended Data Fig. 6 of ref.17also showed sensitivity to single-qubit errors, as the probability distribution between entangled and non-entangled states was not fixed as a function of the number of CZ gates.

*** To mitigate this effect, we design a randomized circuit (Extended Data Fig.3a) such that the probability of finding any one of the 12 two-qubit symmetric stabilizer states would be uniform, irrespective of the number of CZ gates, at each stage of the circuit47. We term this circuit the symmetric stabilizer benchmarking (SSB) circuit. Specifically, the probabilities of finding an entangled or separable state are equal throughout the circuit.

*** Using an interleaved experimental comparison, we find a difference of about 3 × 10−3between benchmarking methods in the fidelity directly inferred from the slope of the return probability (Extended Data Fig.3b). This difference stems from the higher sensitivity of the echo circuit benchmarking to single-qubit gate errors. This observation is in good agreement with a full error model that accounts for both clock and Rydberg excitation imperfections (Extended Data Fig.3c). This model confirms that the fidelity inferred from the symmetric stabilizer benchmarking circuit is an accurate proxy of the gate fidelity averaged over all two-qubit symmetric stabilizer states. We confirm that this observation holds over a wide range of error rates by rescaling the strength of individual error sources in the numerical model (Extended Data Fig.3c). These include incoherent and coherent errors. However, note that coherent errors or gate miscalibration of larger magnitude would result in an increased error in estimating the gate fidelity, which is a common issue across various benchmarking techniques. Also note that the gate fidelity averaged over all two-qubit symmetric stabilizer states is equal to the gate fidelity averaged over two-qubit symmetric input states. This can be seen because these symmetric stabilizer states form a quantum state two-design on the symmetric subspace47.

*** We read out the return probability for the randomized circuit benchmarking by pushing out ground-state atoms and pumping clock-state atoms to the ground state for imaging. As part of this optical pumping, any population in the3P2state would be pumped and identified as bright, which is the clock-state population. We, thus, correct for leakage from the Rydberg state into the state3P2identified as bright. We separately measure the decay into3P2per gate by repeating the benchmarking sequence, which is followed by pushing out the atoms in the qubit subspace and repumping the3P2state for imaging. At a Rydberg Rabi frequency of 5.4 MHz, the false contribution to the CZ fidelity is measured to be 1.8(4) × 10−4per gate, in good agreement with numerical predictions. The CZ fidelity quoted throughout this work has been corrected downwards for this effect.

*** Our model for the two-qubit gate accounting for Rydberg errors is based on previous modelling of errors during Rydberg entangling operations58,65. We adapt it to model the dynamics of a three-level system with ground (\(| 0\rangle \)), clock (\(| 1\rangle \)), and Rydberg states (\(| r\rangle \)). Following the optimization of the gate parameters for a time-optimal pulse17,18in the error-free case (Extended Data Fig.4a), we fix these parameters and simulated noisy dynamics with the Monte Carlo wavefunction approach. The model includes Rydberg laser intensity noise, Rydberg laser frequency noise, Rydberg decay (quantum jumps) and atomic motion. The predicted contribution of each error source to the CZ gate infidelity is shown in Extended Data Fig.4c. For the analysis shown in Extended Data Fig.3c, we repeat the numerical simulation several times and change the magnitude of one of the error model parameters in each run. For example, we rescale the overall magnitude of the noise PSD for frequency or intensity noise or the Rydberg decay rate.

*** Here, we discuss the general data-taking procedure for all experiments described in the main text. Typically, each experimental repetition takes approximately 1 s. To collect enough statistics, we perform the same sequence for from several hours up to several days (for the randomized circuit two-qubit gate characterization). However, on this timescale, the clock laser reference cavity experiences environmental fluctuations, resulting in clock laser frequency drifts from approximately 10 to approximately 100 Hz over a timescale of approximately 10 min.

*** We, thus, interleave data-taking with calibration and feedback runs16,65. To measure the clock laser detuning from atomic resonance, we perform Rabi spectroscopy with the same nominal power and π pulse time as used in the experiment. The laser frequency is then shifted accordingly by an acousto-optic modulator. Such feedback is performed every 5–10 min, depending on the details of the experimental sequence. We reccord the applied laser frequency shifts, which can serve as an indicator of the clock laser stability during the experimental runs. To compare the stability from experiment to experiment, we take the standard deviation of the feedback values. In the main text, the gate benchmarking (Fig.2a,b) and the simultaneous preparation of a cascade of GHZ states (Fig.3) have feedback standard deviations of 73 and 68 Hz, respectively. During the data-taking of the optical-clock-transition Bell-state generation experiment (Fig.2c,d), the feedback standard deviation is 203 Hz, significantly higher than other experiments. To ensure the consistency of clock laser conditions among all experiments, we select the Bell-state generation experimental runs with associated clock laser feedbacks of less than 100 Hz. After applying this cutoff, the standard deviation of the feedback frequencies is 67 Hz, comparable with the other experiments.

*** To study the effects of the short-term clock stability, we analyse the Bell-state parity experimental runs with associated clock feedback frequencies less than a certain cutoff. With the cutoff frequency increasing from 100 Hz (results are presented in Fig.2d) to 400 Hz (all data included), the parity contrast shows a clear decreasing trend (Extended Data Fig.6a). This is consistent with our Bell-pair generation fidelity being limited by clock laser phase noise.

*** In contrast, note that using the randomized symmetric stabilizer benchmarking circuit to characterize the CZ gate itself, our results are consistent run to run and day to day within our experimental error bars. This further attests to the largely reduced sensitivity of this sequence to single-qubit gate errors stemming from clock laser drift and clock laser phase noise.

*** Error bars on individual data points throughout this work represent 68% confidence intervals for the standard error of the mean. If not visible, error bars are smaller than the markers. The randomized circuit return probability shown in Fig.2band the parity signal shown in Fig.2dare fitted using the maximum-likelihood method58(see details in the next section). Error bars on fitted parameters represent one standard deviation. Fitting for all other experimental data is done using the weighted least squares method.

*** We analyse the results of the Bell-state experiments as in our previous work58. We use a beta distribution to assess the underlying probabilities. For the parity signal shown in Fig.2d, we fit the data with a sine function with four free parameters: offset, contrast, phase and frequency. We find that using the maximum-likelihood method while taking the underlying beta distribution of each data point into account is necessary, as the standard Gaussian fit typically overestimate the contrast by approximately 0.015. This is because the beta distribution deviates from a Gaussian distribution when the two-atom parity is close to ±1, which breaks the underlying assumption of a Gaussian fit. From this, we obtain a parity contrast of\(0.96{3}_{-10}^{+7}\)(\(0.98{3}_{-10}^{+7}\)SPAM corrected). Together with the measured population overlapP00+P11=\(0.98{8}_{-7}^{+5}\)(\(0.99{4}_{-7}^{+5}\)SPAM corrected) (not shown), we obtain a Bell-state generation fidelity of\(0.97{6}_{-6}^{+4}\)(\(0.98{9}_{-6}^{+4}\)SPAM corrected). These results are obtained by analysing experimental runs with associated clock feedback frequencies of less than 100 Hz.

*** The dominant measurement error stems from the long tails in a typical fluorescence imaging scheme. In our experiment, we infer the imaging true negative and true positive rates asF0= 0.99997 andF1= 0.99995, respectively, from experimental measurements through a model-free calculation (ref.66, section 2.6.7). Note that these are not state detection fidelities in a circuit, as state detection in a circuit would require a further push-out before imaging62. The probability of successfully expelling the ground-state atom from the trap for state discrimination isB= 0.9989(1). Taking these into account, the single-atom measurement-corrected values\({P}_{0}^{{\rm{m}}}\)and\({P}_{1}^{{\rm{m}}}\)have the following relation with the raw values\({P}_{0}^{{\rm{r}}}\)and\({P}_{1}^{{\rm{r}}}\):

*** where\(A={[B({F}_{0}+{F}_{1}-1)]}^{-1}=1.0012\)and\(C=1-{F}_{1}{[B({F}_{0}+{F}_{1}-1)]}^{-1}=-0.0011\). By assuming that a measurement was independent among the atoms, we extend this correction to multi-qubit measurements by taking the Kronecker product of the above matrix.

*** After correcting the measurements, we then correct for state preparation errors for the Bell-pair generation circuit (Extended Data Fig.8). At the circuit initialization (state preparation) stage, we implement an erasure-cooling scheme44and analysed the results conditioned on no erasure detected. We identify that the dominant imperfections in this state preparation stage are (1) atom loss (with probabilityεl= 0.0027 for a single atom) and (2) decay from\(| 1\rangle \)to\(| 0\rangle \)(with probabilityεd= 0.0037 for a single atom). We keep track of how all two-qubit initial states (\(| 11\rangle ,| 10\rangle ,| 01\rangle ,| 1,\,{\rm{lost}}\rangle ,| {\rm{lost}},1\rangle ,\)…) contribute to the population distribution and the coherence at the measurement stage.

*** For the population distribution, apart from the ideal initial state\(| 11\rangle \), we keep track of how the erroneous initial states evolve under a perfect circuit execution and contribute to the final population distribution (Extended Data Fig.8). We correct the bit-string populations to the first order ofεdandεl. Following the probability tree, we can write:

*** where the bit-string probabilities\({P}_{{\rm{b}}}^{{\rm{m}}}\)are measurement-corrected and\({P}_{{\rm{b}}}^{{\rm{c}}}\)(the SPAM-corrected population) are issued from perfect initial state preparation, inherent to the quantum circuit execution errors.

*** For the coherence measurement, we keep track of how the different erroneous initial states contribute to the observed parity contrast. The error channel with one lost atom (initial state being\(| 1,\,\text{lost}\rangle \)or\(| \text{lost},\,1\rangle \)) does not affect the contrast due to having a different oscillation frequency. On the other hand, if an atom has decayed to the ground state (\(| 01\rangle \)or\(| 10\rangle \)), its parity oscillation frequency remains the same but with a π phase shift and a contrast of 0.5. This contributes negatively to the observed parity contrast. Hence, the measured parity oscillation contrastCm(after measurement correction), in terms of the SPAM-corrected contrastCc, to the first order of error probabilities, is

*** In the main text, there are several results where the analysis of a final image is conditioned on a preceding fast image that verified the state preparation (after erasure-cooling) or motional qubit initialization (after shelving). First, note that erasure-cooling is needed strictly only for the motional qubit initialization in mid-circuit measurements. Additionally, we find improved single-qubit (clock) gate fidelities following erasure-cooling, and this improvement becomes significant for shallow tweezers. In contrast, the improvement in CZ gate fidelity following erasure-cooling is insignificant. In the full error model, we find only a 2 × 10−5increase when cooling the radial degree of freedom to its motional ground state.

*** For experiments in which MCR is applied (Figs.4and5), we report the results conditioned on not detecting atoms in the ground state after a shelving pulse44. We provide the results here with no conditioning for completeness. For measurement-based Bell-state generation (Fig.5d), without erasure excision, the contrast is 0.39(3), and the population overlap would be 0.64(2), yielding a raw Bell-state fidelity of 0.52(2). For ancilla-based\(\widehat{X}\)measurement (Fig.4c), the contrast, conditioned on the ancilla result\(| 0\rangle \)(\(| 1\rangle \)), is 0.60(3) (0.45(3)).

*** We attribute the limited shelving fidelity mostly to the limited Rabi frequency on the sideband transition, compared with typical frequency variations of the addressing laser or the trap frequency. Further limitations may arise from the uniformity of the trap waists (and depths) of different tweezers across the array. These limitations can be overcome with a more stable clock laser or by employing more advanced pulse sequences designed to be insensitive to such inhomogeneities67.

*** As discussed in the main text, during the preparation of the four-qubit GHZ state, the entangled state is vulnerable to finite atomic temperature and clock laser noise. Entangled states dephase during the array reconfiguration time, which is considered idle time in the quantum circuit, due to laser frequency noise. To quantitatively study the effect of laser frequency noise, we perform the experiment with different idle times. We then measure the parity oscillation contrast and the population overlap of the four-qubit GHZ state and compared with our error model predictions, assuming perfect CZ gates (Extended Data Fig.9). The experimental pulse sequence is shown in Extended Data Fig.9a. We increase the total idle time from 280 to 840 μs per arm and observe a decrease in both the overlap of the GHZ-state population and the parity oscillation contrast (Extended Data Fig.9c,e). We also observe similar trends in a numerical simulation with our error model, which assumes perfect CZ gates, a finite temperature of\(\bar{n}=0.24\)and the calibrated clock laser frequency PSD. With the actual reconfiguration time (280 μs), this error model predicts the parity oscillation contrast to be 0.66 and the state fidelity to be 0.75, consistent with our experimental realization (contrast being 0.68(3) and fidelity being 0.71(2)).

*** The experimental results with the variable idle time show that the generation fidelity of four-qubit GHZ states is limited by the clock laser frequency noise. This motivates us to simulate this state generation circuit with our clock error model and the frequency PSD of a 26-mHz laser53. Keeping a finite temperature of\(\bar{n}=0.24\)and assuming perfect CZ gates, we find a contrast of 0.79 and a fidelity of 0.84 (Extended Data Fig.6b). With this reduced frequency noise, we find the four-qubit GHZ generation fidelity less sensitive to the idle time. For the simultaneous generation of a cascade of GHZ states, we find that the four-qubit GHZ fidelity is consistent with the shorter idle time sequence. Furthermore, with zero temperature (\(\bar{n}=0\)), the clock error model predicts near-unity state fidelity (over 0.999). In this low-temperature and 26-mHz clock laser scenario, the state fidelity is limited by the entangling gate fidelity. With the high-fidelity entangling gate demonstrated in this work, we estimate the generation fidelity of four-qubit GHZ states to be approximately 0.97. This improvement of the atomic temperature could readily be achieved by erasure-cooling44or other methods68. Note that erasure-cooling is not applied during this particular experiment to speed up the data-taking on a four-atom register.

*** We analyse the experimental fidelities required to obtain a metrological gain in phase estimation. The metrological gaingis defined as the ratio of posterior variances2. If we consider the gain of a protocol withNentangled atoms over the interrogation ofNuncorrelated atoms, it can be written as\(g={(\Delta {\phi }_{{\rm{UC}}})}^{2}/{(\Delta {\phi }_{{\rm{C}}})}^{2}\), where\({(\Delta {\phi }_{{\rm{C}}})}^{2}\)and\({(\Delta {\phi }_{{\rm{UC}}})}^{2}\)are the posterior variances for the entangled case and the uncorrelated case, respectively. For both cases, we assume a dual-quadrature read-out5,16,51. We first describe the expected metrological gain with perfect state preparation and then consider the case of imperfect state preparation.

*** There are two distinct regimes for phase estimation. Local phase estimation corresponds to the limit of a vanishing prior phase width or equivalently to short interrogation times in atomic clocks. This limit holds only if the prior phase width is smaller than the dynamic range of the quantum state. In this limit, the optimal probe state is anN-atom GHZ state, and the gain is2g≈N.

*** For a large phase prior distribution width or equivalently for long interrogation times in atomic clocks, GHZ states do not provide a metrological gain due to their limited dynamic range, so that new protocols are needed. In the main text, we consider the protocol proposed in refs.1,4and demonstrate a scheme to generate the required input state and read out the phase in both quadratures (Fig.3). The protocol usesNatoms divided intoMgroups of GHZ states withK= 2jatoms each, wherej= 0, …,M− 1. The number of atoms in the largest GHZ state is, thus,\({K}_{\max }={2}^{M-1}.\)The projected metrological gain with ideal state preparation was predicted to be\(g\approx {{\rm{\pi }}}^{2}N/(64\log (N))\)(ref.4). The gain can be understood by considering phase estimation at the Heisenberg limit for the largest GHZ state, which containedN/2 atoms. To exponentially suppress rounding errors in phase estimation, one needs to usen0copies of each GHZ state with\({n}_{0}=(16/{{\rm{\pi }}}^{2})\log ({\rm{N}})\). Note that these expressions hold only in the limit of largeN.

*** We now consider a limited number of atomsNand analyse the effect of finite state preparation fidelity on the projected metrological gain. We assume that the interrogation time is long and perform numerical Bayesian phase estimation. We use a Gaussian prior distribution to model the prior knowledge of the laser phase. For Bayesian phase estimation, the posterior variance of a given protocol depends on the variance of the prior distribution. The figure of merit of phase estimation is typically given by6,37R= ΔϕC/δϕ, whereδϕis the prior phase distribution width.Rquantifies how much information was obtained in the measurement compared to our initial knowledge of the parameter. It has been shown numerically that for relevant values ofN(N≈ 100), the optimal performance, quantified byR, is obtained for a phase prior width aroundδϕ= 0.7 rad for a large class of states6,37. We, therefore, choose to work with this prior width. Experimentally, the prior width is set by the Ramsey interrogation time and can be tuned to this optimal value.

*** Using the protocol in ref.4for GHZ states with one, two or four atoms, the minimal number of copies per GHZ size isn0= 6, resulting inN= 42 atoms (Extended Data Fig.7). Using optimal Bayesian estimators37, we find numerically a metrological gain of 1.627 (2.114 dB) with perfect state preparation. Imperfect preparation fidelity results in a parity signal with limited contrastC(K) for aK-atom GHZ state. The probabilities for the outcome of a parity measurement are then modified to\(P(\pm )=(1\pm C(K)\cos (K\phi ))/2\), where {+, −} denote even and odd parity, respectively.

*** To estimate the effect of such limited contrast on the metrological gain, we consider two characteristic scenarios, motivated by our experimental results. First, we look at a case with perfect state preparation for the one-atom and two-atom GHZ states (C(1) =C(2) = 1), whereas the four-atom GHZ state has a finite parity signal contrastC(4). In this case, we find numerically that the minimal contrast to obtain a gaing≥ 1 isC(4) = 0.656. This is higher than the threshold contrast for a narrow prior width given the same state, that is\(C\ge 1/\sqrt{{K}_{\max }}=0.5\)(refs.2,52).

*** Second, we look at a case where the contrast of each GHZ state scales as\(C(K)={F}_{0}^{K}\), whereF0is the effective fidelity per qubit. We repeat the calculation and find that the threshold fidelity to obtain a gain wasF0= 0.969, or equivalently a contrast ofC(4) = 0.9694= 0.883 for the four-atom GHZ state. Numerically, this threshold seems to be robust to the introduction of more copies of the one-atom and two-atom GHZ states: ifn0= 12 only for these states (keepingn0= 6 for the four-atom GHZ states), the threshold is only slightly reduced toF0≳0.965. Finally, we show the projected metrological gain for variousF0with respect to the number of atoms in the largest GHZ state used in the protocol of ref.4in Extended Data Fig.7.

*** Our experimental values forC(K) from the simultaneous GHZ-state generation scheme (C(1) = 0.82,C(2) = 0.68 andC(4) = 0.52) fall between the two cases considered here: the best case scenario ofC(K) = 1 for\(K < {K}_{\max }\)and the worst case scenario of\(C(K)={F}_{0}^{K}\). Hence, we expect the threshold for metrological gain to lie between the values obtained from these two cases.

*** Note that the observed parity oscillation contrasts in our current experimental demonstration are below these thresholds. However, the contrast reduction is entirely dominated by clock laser noise (Extended Data Fig.6). With the high-fidelity CZ gates obtained in this work, whereFCZ≈ 0.996, combined with a reduced clock laser noise (achieved, for example, by a laser with frequency PSD as in ref.53as discussed above), we numerically project a performance superior to the same number of uncorrelated atoms. Specifically, if we assumeF0≈ 0.996, the predicted metrological gain with six copies of GHZ states with one, two or four atoms each is calculated to be 1.519 (1.815 dB). If eight-atom GHZ states are included, the predicted metrological gain with eight copies of GHZ states with one, two, four or eight atoms each is calculated to be 1.893 (2.772 dB). Note that the above gain analysis assumes zero dead time. Introducing dead time would degrade the gain, and we defer the analysis of this effect to future work.

*** For the MCR illustrated in Fig.4, fast 18 μs imaging58is applied with a fidelity of approximately 0.96 at a tweezer spacing of 3.3 μm. The strong driving on the1S0↔1P1transition without cooling results in the low survival of detected atoms. Therefore, for experiments where repeated ancilla measurements are needed, we refill the original ancilla position with another atom through array reconfiguration. Alternatively, we recool and reuse the ancilla atoms instead of refilling them. In this section, we describe a proof-of-concept experiment with different imaging parameters for the ancilla atoms (Extended Data Fig.10).

*** The new imaging scheme is based on the standard high-fidelity, high-survival imaging with cooling light (1S0↔3P1intercombination line)62. We increase the imaging power to collect more photons over 10 ms and apply the cooling light on one of the axes for another 10 ms, which is shorter than the motional shelving coherence time  of approximately 100 ms (ref.44). This imaging scheme allows us to obtain an imaging fidelity of 0.98 with 0.965(2) survival (Extended Data Fig.10a).

*** We then check whether we could coherently apply single-qubit rotations after this 10 ms imaging by applying a π/2 pulse and a second π/2 pulse with a variable phase (Extended Data Fig.10b). The measured coherence after imaging 0.94(1) (Extended Data Fig.10c) is mainly limited by survival, which could readily be improved with further optimizations on cooling during the imaging. Once added to the complete MCR (Extended Data Fig.10d), we see a similar coherence for the detected atoms in the ground state (blue) and a slightly lower coherence for the undetected atoms in the clock state (red), due to the decay (time constant approximately 300 ms) during the 10 ms cooling. These decayed atoms contribute doubly to the loss of coherence of approximately 0.07. With this coherent driving, we can see when the ancilla atoms are ready to be reused. In the same experiment, we also measure a coherence of approximately 0.73 on the shelved atoms after unshelving them (not shown), matching the numbers for motional coherence in our previous work44.

*** Here, we give the fitted parameters of the plot presented in Fig.5b. For the direct read-out on the Bell pair, we fit an oscillation of 16.5(1) kHz with a phase 3.16(7) rad and a contrast of 0.77(3). The ancilla read-out gives a Ramsey oscillation of 16.5(2) kHz with a phase of 3.19(9) rad and a contrast of 0.59(4). In a separate experiment interleaved with this experiment, we measure the single-atom detuning to be 8.26(5) kHz.

*** With perfect gates, the quantum circuit in Fig.5ayields an oscillating state between\(| {\varPhi }^{+}\rangle \otimes {| 0\rangle }_{{\rm{ancilla}}}\)and\(| {\varPhi }^{-}\rangle \otimes {| 1\rangle }_{{\rm{ancilla}}}\). For either state, the pair would be measured in\(| 00\rangle \)or\(| 11\rangle \)in this ideal case. Given this information, one can post-select on the experimental repetitions where the pair is measured in the expected state, either\(| 00\rangle \)or\(| 11\rangle \). This post-selection could identify errors in the execution of the circuit. Looking at the oscillating state, this post-selection should not bias either of the ancilla measurement outcomes. Performing this post-selection analysis (not shown), we see a Ramsey oscillation of 16.5(3) kHz and a contrast of 0.71(8).

